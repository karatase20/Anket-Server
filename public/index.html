<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Risk DeÄŸerlendirme Anketi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #f0f0f0;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }
        
        .rules {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #3498db;
        }
        
        .rules h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .rules h3::before {
            content: "ğŸ“‹";
        }
        
        .rule-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
        }
        
        .rule-item {
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .rule-item::before {
            content: "âœ“";
            color: #27ae60;
            font-weight: bold;
        }
        
        .status-bar {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 15px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .status-item {
            text-align: center;
            flex: 1;
            min-width: 150px;
        }
        
        .status-value {
            font-size: 2rem;
            font-weight: bold;
            display: block;
        }
        
        .images-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .image-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            border: 3px solid #e0e0e0;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .image-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .image-card.selected-gold {
            border-color: #FFD700;
            background: linear-gradient(135deg, #fff9db, #fff3bf);
        }
        
        .image-card.selected-silver {
            border-color: #C0C0C0;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        }
        
        .image-card img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            display: block;
        }
        
        .image-info {
            padding: 20px;
            text-align: center;
        }
        
        .image-info h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .vote-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }
        
        .vote-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            max-width: 120px;
        }
        
        .vote-gold {
            background: linear-gradient(135deg, #FFD700, #FFC107);
            color: #333;
        }
        
        .vote-silver {
            background: linear-gradient(135deg, #C0C0C0, #9e9e9e);
            color: white;
        }
        
        .vote-btn:hover:not(:disabled) {
            transform: scale(1.05);
        }
        
        .vote-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .submit-container {
            text-align: center;
            margin: 30px 0;
        }
        
        #submit-btn {
            background: linear-gradient(135deg, #27ae60, #219653);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }
        
        #submit-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(39, 174, 96, 0.4);
        }
        
        #submit-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .results-container {
            margin-top: 40px;
            padding: 25px;
            border-radius: 15px;
            background: #f8f9fa;
            border: 2px dashed #3498db;
            display: none;
        }
        
        .results-container h2 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 1.8rem;
        }
        
        .results-container h2::before {
            content: "ğŸ“Š";
            margin-right: 10px;
        }
        
        .scores-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .score-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }
        
        .score-card h3 {
            color: #7f8c8d;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .score-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #3498db;
        }
        
        #results-message {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
            font-weight: bold;
            font-size: 1.1rem;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .real-time-badge {
            background: #27ae60;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-left: 10px;
        }
        
        .real-time-badge::before {
            content: "ğŸ”„";
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .images-container {
                grid-template-columns: 1fr;
            }
            
            .vote-buttons {
                flex-direction: column;
            }
            
            .vote-btn {
                max-width: 100%;
            }
            
            .status-bar {
                flex-direction: column;
                text-align: center;
            }
            
            .status-item {
                min-width: 100%;
            }
        }
        
        .badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #e74c3c;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .selected-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
        }
        
        .selected-gold .selected-badge {
            background: #FFD700;
            content: "3 PUAN";
        }
        
        .selected-silver .selected-badge {
            background: #C0C0C0;
            content: "1 PUAN";
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ† Risk DeÄŸerlendirme Anketi</h1>
            <p class="subtitle">GÃ¶rselleri puanlayÄ±n, geleceÄŸe yÃ¶n verin</p>
        </header>
        
        <div class="rules">
            <h3>Anket KurallarÄ±</h3>
            <div class="rule-list">
                <div class="rule-item">Her katÄ±lÄ±mcÄ± <strong>2 oy</strong> kullanacak</div>
                <div class="rule-item">Birincil tercih <strong>3 PUAN</strong> deÄŸerinde</div>
                <div class="rule-item">Ä°kincil tercih <strong>1 PUAN</strong> deÄŸerinde</div>
                <div class="rule-item">AynÄ± gÃ¶rsele Ã§ift oy <strong>verilemez</strong></div>
                <div class="rule-item">Toplam <strong>3 katÄ±lÄ±mcÄ±</strong> oy kullanacak</div>
                <div class="rule-item">SonuÃ§lar <strong>gerÃ§ek zamanlÄ±</strong> gÃ¼ncellenir</div>
            </div>
        </div>
        
        <div class="status-bar">
            <div class="status-item">
                <span>Kalan Oy HakkÄ±nÄ±z</span>
                <span class="status-value" id="votes-left">2</span>
            </div>
            <div class="status-item">
                <span>Kalan KatÄ±lÄ±mcÄ±</span>
                <span class="status-value" id="remaining-users">3</span>
            </div>
            <div class="status-item">
                <span>Anket Durumu</span>
                <span class="status-value" id="survey-status">Aktif</span>
            </div>
        </div>
        
        <div class="images-container">
            <!-- GÃ¶rsel 1 -->
            <div class="image-card" data-image-id="1">
                <div class="selected-badge" style="display: none;">SEÃ‡Ä°LDÄ°</div>
                <img src="gorsel1.jpg" alt="Risk Senaryosu 1" id="img-1">
                <div class="image-info">
                    <h3>GÃ¶rsel 1</h3>
                    <div class="vote-buttons">
                        <button class="vote-btn vote-gold" id="btn-1-3" data-image="1" data-points="3">ğŸ¥‡ 3 Puan</button>
                        <button class="vote-btn vote-silver" id="btn-1-1" data-image="1" data-points="1">ğŸ¥ˆ 1 Puan</button>
                    </div>
                </div>
            </div>
            
            <!-- GÃ¶rsel 2 -->
            <div class="image-card" data-image-id="2">
                <div class="selected-badge" style="display: none;">SEÃ‡Ä°LDÄ°</div>
                <img src="gorsel2.jpg" alt="Risk Senaryosu 2" id="img-2">
                <div class="image-info">
                    <h3>GÃ¶rsel 2</h3>
                    <div class="vote-buttons">
                        <button class="vote-btn vote-gold" id="btn-2-3" data-image="2" data-points="3">ğŸ¥‡ 3 Puan</button>
                        <button class="vote-btn vote-silver" id="btn-2-1" data-image="2" data-points="1">ğŸ¥ˆ 1 Puan</button>
                    </div>
                </div>
            </div>
            
            <!-- GÃ¶rsel 3 -->
            <div class="image-card" data-image-id="3">
                <div class="selected-badge" style="display: none;">SEÃ‡Ä°LDÄ°</div>
                <img src="gorsel3.jpg" alt="Risk Senaryosu 3" id="img-3">
                <div class="image-info">
                    <h3>GÃ¶rsel 3</h3>
                    <div class="vote-buttons">
                        <button class="vote-btn vote-gold" id="btn-3-3" data-image="3" data-points="3">ğŸ¥‡ 3 Puan</button>
                        <button class="vote-btn vote-silver" id="btn-3-1" data-image="3" data-points="1">ğŸ¥ˆ 1 Puan</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="submit-container">
            <button id="submit-btn" disabled>
                ğŸ“¨ OYUMU GÃ–NDER
            </button>
        </div>
        
        <div class="loading" id="loading">
            <div class="loader"></div>
            <p>Oy gÃ¶nderiliyor...</p>
        </div>
        
        <div id="results-message">
            <!-- SonuÃ§ mesajlarÄ± burada gÃ¶rÃ¼necek -->
        </div>
        
        <div id="total-results" class="results-container">
            <h2>ğŸ“Š CANLI ANKET SONUÃ‡LARI</h2>
            <div class="scores-grid">
                <div class="score-card">
                    <h3>GÃ¶rsel 1</h3>
                    <div class="score-value" id="score-1">0</div>
                    <p>Toplam Puan</p>
                </div>
                <div class="score-card">
                    <h3>GÃ¶rsel 2</h3>
                    <div class="score-value" id="score-2">0</div>
                    <p>Toplam Puan</p>
                </div>
                <div class="score-card">
                    <h3>GÃ¶rsel 3</h3>
                    <div class="score-value" id="score-3">0</div>
                    <p>Toplam Puan</p>
                </div>
            </div>
            <p style="text-align: center; margin-top: 20px; color: #7f8c8d;">
                <span class="real-time-badge"></span> SonuÃ§lar otomatik olarak gÃ¼ncellenir
            </p>
        </div>
        
        <footer>
            <p>Ascan AlÃ¼minyum Risk DeÄŸerlendirme Anketi</p>
            <p><small>Bu anket 3 katÄ±lÄ±mcÄ± ile sÄ±nÄ±rlÄ±dÄ±r. SonuÃ§lar gerÃ§ek zamanlÄ± olarak paylaÅŸÄ±lÄ±r.</small></p>
        </footer>
    </div>

    <script>
    // ğŸ“Œ ANKET SÄ°STEMÄ° - TAM KOD
    console.log('âœ… Anket sistemi baÅŸlatÄ±lÄ±yor...');
    
    // API URL'si (sunucu adresi)
    const API_URL = window.location.origin;
    
    // Mevcut kullanÄ±cÄ±nÄ±n oylarÄ±
    let myVotes = {
        vote3: null, // 3 puan verdiÄŸi gÃ¶rsel ID
        vote1: null  // 1 puan verdiÄŸi gÃ¶rsel ID
    };
    
    // Sayfa yÃ¼klendiÄŸinde
    window.onload = async function() {
        console.log('ğŸ“„ Sayfa yÃ¼klendi, anket hazÄ±rlanÄ±yor...');
        await updateSurveyStatus();
        setupEventListeners();
        
        // Her 5 saniyede bir anket durumunu gÃ¼ncelle
        setInterval(updateSurveyStatus, 5000);
        
        console.log('ğŸš€ Anket sistemi hazÄ±r!');
    };
    
    // Event listener'larÄ± kur
    function setupEventListeners() {
        console.log('ğŸ”§ Buton eventleri ayarlanÄ±yor...');
        
        // TÃ¼m oy butonlarÄ±na click eventi ekle
        document.querySelectorAll('.vote-btn').forEach(button => {
            button.addEventListener('click', function() {
                const imageId = parseInt(this.getAttribute('data-image'));
                const points = parseInt(this.getAttribute('data-points'));
                addVote(imageId, points);
            });
        });
        
        // GÃ¶nder butonu
        document.getElementById('submit-btn').addEventListener('click', submitVote);
        
        // GÃ¶rsellere tÄ±klama (isteÄŸe baÄŸlÄ±)
        document.querySelectorAll('.image-card img').forEach(img => {
            img.addEventListener('click', function() {
                const card = this.closest('.image-card');
                const imageId = parseInt(card.getAttribute('data-image-id'));
                const isSelectedGold = card.classList.contains('selected-gold');
                const isSelectedSilver = card.classList.contains('selected-silver');
                
                if (!isSelectedGold && !isSelectedSilver) {
                    if (confirm(`GÃ¶rsel ${imageId}'i kaÃ§ puan vermek istersiniz?\n\n"Tamam" = 3 Puan\n"Ä°ptal" = 1 Puan`)) {
                        addVote(imageId, 3);
                    } else {
                        addVote(imageId, 1);
                    }
                }
            });
        });
    }
    
    // Oy ekleme fonksiyonu
    function addVote(imageId, points) {
        console.log(`ğŸ¯ Oy ekleniyor: GÃ¶rsel ${imageId}, ${points} Puan`);
        
        // AynÄ± puan tÃ¼rÃ¼nÃ¼ daha Ã¶nce kullandÄ± mÄ±?
        if (points === 3 && myVotes.vote3 !== null) {
            alert('âŒ 3 puanlÄ±k oyunuzu zaten kullandÄ±nÄ±z!');
            return;
        }
        
        if (points === 1 && myVotes.vote1 !== null) {
            alert('âŒ 1 puanlÄ±k oyunuzu zaten kullandÄ±nÄ±z!');
            return;
        }
        
        // AynÄ± gÃ¶rsele zaten oy verdi mi?
        if ((points === 3 && myVotes.vote1 === imageId) || 
            (points === 1 && myVotes.vote3 === imageId)) {
            alert('âŒ AynÄ± gÃ¶rsele hem 3 hem 1 puan veremezsiniz!');
            return;
        }
        
        // Oy kaydet
        if (points === 3) {
            myVotes.vote3 = imageId;
        } else {
            myVotes.vote1 = imageId;
        }
        
        // GÃ¶rseli iÅŸaretle
        updateImageSelection(imageId, points);
        
        // Kalan oy hakkÄ±nÄ± gÃ¼ncelle
        updateRemainingVotes();
        
        // GÃ¶nder butonunu kontrol et
        checkSubmitButton();
        
        console.log('âœ… Oy eklendi:', myVotes);
    }
    
    // GÃ¶rsel seÃ§imini gÃ¼ncelle
    function updateImageSelection(imageId, points) {
        const card = document.querySelector(`[data-image-id="${imageId}"]`);
        const badge = card.querySelector('.selected-badge');
        
        // Ã–nceki seÃ§imleri temizle (aynÄ± gÃ¶rselde)
        card.classList.remove('selected-gold', 'selected-silver');
        
        // Yeni seÃ§imi ekle
        if (points === 3) {
            card.classList.add('selected-gold');
            badge.textContent = '3 PUAN';
            badge.style.display = 'block';
            badge.style.background = '#FFD700';
        } else {
            card.classList.add('selected-silver');
            badge.textContent = '1 PUAN';
            badge.style.display = 'block';
            badge.style.background = '#C0C0C0';
        }
    }
    
    // Kalan oy hakkÄ±nÄ± gÃ¼ncelle
    function updateRemainingVotes() {
        const votesLeft = (myVotes.vote3 === null ? 1 : 0) + (myVotes.vote1 === null ? 1 : 0);
        document.getElementById('votes-left').textContent = votesLeft;
    }
    
    // GÃ¶nder butonunu kontrol et
    function checkSubmitButton() {
        const submitBtn = document.getElementById('submit-btn');
        if (myVotes.vote3 !== null && myVotes.vote1 !== null) {
            submitBtn.disabled = false;
            console.log('âœ… GÃ¶nder butonu aktif edildi');
        } else {
            submitBtn.disabled = true;
        }
    }
    
    // Sunucudan anket durumunu gÃ¼ncelle
    async function updateSurveyStatus() {
        try {
            console.log('ğŸ”„ Anket durumu gÃ¼ncelleniyor...');
            
            // Bu Ã¶rnekte sunucu olmadÄ±ÄŸÄ± iÃ§in local storage kullanÄ±yoruz
            // GerÃ§ek uygulamada: const response = await fetch(`${API_URL}/api/survey`);
            
            // SimÃ¼le edilmiÅŸ sunucu yanÄ±tÄ±
            const mockData = {
                totalScores: {
                    "1": localStorage.getItem('score_1') ? parseInt(localStorage.getItem('score_1')) : 0,
                    "2": localStorage.getItem('score_2') ? parseInt(localStorage.getItem('score_2')) : 0,
                    "3": localStorage.getItem('score_3') ? parseInt(localStorage.getItem('score_3')) : 0
                },
                remainingUsers: localStorage.getItem('remaining_users') ? 
                    parseInt(localStorage.getItem('remaining_users')) : 3,
                surveyActive: localStorage.getItem('survey_active') !== 'false'
            };
            
            // PuanlarÄ± gÃ¶ster
            document.getElementById('score-1').textContent = mockData.totalScores["1"];
            document.getElementById('score-2').textContent = mockData.totalScores["2"];
            document.getElementById('score-3').textContent = mockData.totalScores["3"];
            
            // Kalan katÄ±lÄ±mcÄ±
            document.getElementById('remaining-users').textContent = mockData.remainingUsers;
            
            // Anket durumu
            const statusElement = document.getElementById('survey-status');
            if (mockData.surveyActive) {
                statusElement.textContent = "Aktif";
                statusElement.style.color = "#27ae60";
            } else {
                statusElement.textContent = "Bitti";
                statusElement.style.color = "#e74c3c";
            }
            
            // EÄŸer anket bittiyse
            if (!mockData.surveyActive || mockData.remainingUsers <= 0) {
                endSurvey(mockData.totalScores);
            }
            
        } catch (error) {
            console.error('âŒ Anket durumu gÃ¼ncellenirken hata:', error);
            document.getElementById('survey-status').textContent = "Hata";
            document.getElementById('survey-status').style.color = "#e74c3c";
        }
    }
    
    // Oy gÃ¶nderme fonksiyonu
    async function submitVote() {
        if (myVotes.vote3 === null || myVotes.vote1 === null) {
            alert('âš ï¸ LÃ¼tfen hem 3 puanlÄ±k hem de 1 puanlÄ±k seÃ§iminizi yapÄ±n!');
            return;
        }
        
        // YÃ¼kleniyor gÃ¶ster
        document.getElementById('loading').style.display = 'block';
        document.getElementById('submit-btn').disabled = true;
        
        try {
            console.log('ğŸ“¤ Oy gÃ¶nderiliyor:', myVotes);
            
            // Bu Ã¶rnekte sunucu olmadÄ±ÄŸÄ± iÃ§in local storage'a kaydediyoruz
            // GerÃ§ek uygulamada:
            // const response = await fetch(`${API_URL}/api/vote`, {
            //     method: 'POST',
            //     headers: {'Content-Type': 'application/json'},
            //     body: JSON.stringify(myVotes)
            // });
            
            // SimÃ¼le edilmiÅŸ gecikme
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // Local storage'a kaydet (simÃ¼lasyon)
            const currentScore1 = localStorage.getItem('score_1') ? parseInt(localStorage.getItem('score_1')) : 0;
            const currentScore2 = localStorage.getItem('score_2') ? parseInt(localStorage.getItem('score_2')) : 0;
            const currentScore3 = localStorage.getItem('score_3') ? parseInt(localStorage.getItem('score_3')) : 0;
            const currentRemaining = localStorage.getItem('remaining_users') ? 
                parseInt(localStorage.getItem('remaining_users')) : 3;
            
            // PuanlarÄ± ekle
            if (myVotes.vote3 === 1) localStorage.setItem('score_1', currentScore1 + 3);
            if (myVotes.vote3 === 2) localStorage.setItem('score_2', currentScore2 + 3);
            if (myVotes.vote3 === 3) localStorage.setItem('score_3', currentScore3 + 3);
            
            if (myVotes.vote1 === 1) localStorage.setItem('score_1', currentScore1 + 1);
            if (myVotes.vote1 === 2) localStorage.setItem('score_2', currentScore2 + 1);
            if (myVotes.vote1 === 3) localStorage.setItem('score_3', currentScore3 + 1);
            
            // Kalan katÄ±lÄ±mcÄ±yÄ± azalt
            const newRemaining = Math.max(0, currentRemaining - 1);
            localStorage.setItem('remaining_users', newRemaining);
            
            // EÄŸer 0 olduysa anketi bitir
            if (newRemaining <= 0) {
                localStorage.setItem('survey_active', 'false');
            }
            
            // BaÅŸarÄ± mesajÄ±
            const successMessage = document.getElementById('results-message');
            successMessage.innerHTML = `<span style="color: #27ae60;">âœ… Oyunuz kaydedildi! Kalan katÄ±lÄ±mcÄ±: ${newRemaining}</span>`;
            successMessage.style.display = 'flex';
            
            // Alert mesajÄ±
            alert(`ğŸ‰ TeÅŸekkÃ¼rler! Oyunuz kaydedildi.\nKalan katÄ±lÄ±mcÄ±: ${newRemaining}`);
            
            // SeÃ§imleri sÄ±fÄ±rla
            resetUserSelection();
            
            // EkranÄ± gÃ¼ncelle
            await updateSurveyStatus();
            
        } catch (error) {
            console.error('âŒ Oy gÃ¶nderilirken hata:', error);
            alert('âŒ Bir hata oluÅŸtu! LÃ¼tfen tekrar deneyin.');
        } finally {
            // YÃ¼kleniyor gizle
            document.getElementById('loading').style.display = 'none';
        }
    }
    
    // KullanÄ±cÄ± seÃ§imlerini sÄ±fÄ±rla
    function resetUserSelection() {
        myVotes = { vote3: null, vote1: null };
        
        // GÃ¶rsel iÅŸaretlerini kaldÄ±r
        document.querySelectorAll('.image-card').forEach(card => {
            card.classList.remove('selected-gold', 'selected-silver');
            const badge = card.querySelector('.selected-badge');
            if (badge) badge.style.display = 'none';
        });
        
        // Kalan oy hakkÄ±nÄ± sÄ±fÄ±rla
        document.getElementById('votes-left').textContent = 2;
        
        // GÃ¶nder butonunu devre dÄ±ÅŸÄ± bÄ±rak
        document.getElementById('submit-btn').disabled = true;
        
        console.log('ğŸ”„ KullanÄ±cÄ± seÃ§imleri sÄ±fÄ±rlandÄ±');
    }
    
    // Anket bitince
    function endSurvey(totalScores) {
        console.log('ğŸ Anket tamamlandÄ±!');
        
        // SonuÃ§larÄ± gÃ¶ster
        document.getElementById('total-results').style.display = 'block';
        
        // TÃ¼m butonlarÄ± devre dÄ±ÅŸÄ± bÄ±rak
        document.querySelectorAll('.vote-btn').forEach(btn => {
            btn.disabled = true;
            btn.style.opacity = '0.5';
        });
        
        document.getElementById('submit-btn').disabled = true;
        document.getElementById('submit-btn').textContent = 'ANKET TAMAMLANDI';
        
        // SonuÃ§ mesajÄ±
        const resultsMessage = document.getElementById('results-message');
        resultsMessage.innerHTML = '<span style="color: #e74c3c; font-weight: bold;">ğŸ† ANKET TAMAMLANDI!</span>';
        
        // KazananÄ± belirle
        if (totalScores) {
            const scores = totalScores;
            const winner = Object.keys(scores).reduce((a, b) => scores[a] > scores[b] ? a : b);
            const winnerScore = scores[winner];
            
            // EÅŸitlik kontrolÃ¼
            const winners = Object.keys(scores).filter(key => scores[key] === winnerScore);
            if (winners.length > 1) {
                resultsMessage.innerHTML += `<br><span style="color: #f39c12;">ğŸ… EÅŸitlik! GÃ¶rsel ${winners.join(' ve ')} ${winnerScore} puan</span>`;
            } else {
                resultsMessage.innerHTML += `<br><span style="color: #f39c12;">ğŸ¥‡ Kazanan: GÃ¶rsel ${winner} (${winnerScore} puan)</span>`;
            }
        }
    }
    
    // Debug: Anketi sÄ±fÄ±rlama fonksiyonu
    window.resetSurvey = function() {
        if (confirm('Anketi sÄ±fÄ±rlamak istediÄŸinize emin misiniz?\nTÃ¼m veriler silinecek.')) {
            localStorage.clear();
            resetUserSelection();
            
            // EkranÄ± gÃ¼ncelle
            updateSurveyStatus();
            
            // Mesaj gÃ¶ster
            document.getElementById('results-message').innerHTML = 
                '<span style="color: #3498db;">ğŸ”„ Anket sÄ±fÄ±rlandÄ±!</span>';
            
            alert('âœ… Anket sÄ±fÄ±rlandÄ±!');
        }
    };
    
    console.log('ğŸ“ Anket sistemi yÃ¼klendi. Komutlar:');
    console.log('- resetSurvey(): Anketi sÄ±fÄ±rlar');
    console.log('- myVotes: Mevcut oylarÄ± gÃ¶sterir');
    </script>
</body>
</html>